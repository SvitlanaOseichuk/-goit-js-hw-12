{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\n\nconst URL =\"https://pixabay.com/api/\";\nconst API_KEY = \"42149629-e1e8d2a9238f015bc3d9ce966\";\n\nconst refs = {\n    form: document.getElementById(\"form\"),\n    resultContainer: document.getElementById(\"result-container\"),\n    loadingIndicator: document.querySelector(\".loader\"),\n    loadMoreButton: document.querySelector(\".load-more-button\")\n};\n\n\nconst perPage = 15;\nlet page = 1;\nlet requestForSearch = \"\"; \n\nrefs.form.addEventListener(\"submit\", handleSearch);\nrefs.loadMoreButton.addEventListener(\"click\", loadMoreSearch);\n\nfunction clearResultContainer() {\n  refs.resultContainer.innerHTML = \"\";\n}\n\nfunction showLoadingIndicator() {\n  refs.loadingIndicator.style.display = \"block\";\n}\n\nfunction hideLoadingIndicator() {\n  refs.loadingIndicator.style.display = \"none\";\n}\n\nasync function handleSearch(event) {\n  event.preventDefault();\n  const form = event.currentTarget;\n  requestForSearch = form.elements.search.value.trim();\n\n  clearResultContainer();\n  showLoadingIndicator();\n\n  if (requestForSearch.length === 0) {\n    iziToast.show({\n      message: \"Please, try again!\",\n      color: \"red\",\n    });\n    hideLoadingIndicator();\n    refs.loadMoreButton.classList.add(\"is-hidden\");\n    return;\n  }\n\n  try {\n    const data = await searchPictures(requestForSearch);\n    const pictures = data.hits;\n    if (pictures.length === 0) {\n          iziToast.show({\n            message: \"Sorry, there are no images matching your search query. Please try again!\"\n        });\n    } else {\n        let markup = \"\"\n        for (const pic of pictures) {\n            markup +=createPicturesMarkup(pic);\n        }\n    refs.resultContainer.innerHTML = markup;\n               \n               \n        const lightbox = new SimpleLightbox(\".image-container a\", {\n            captionsData: \"alt\", \n            captionDelay: 250,\n        });\n    }\n    if (pictures.length > 0) {\n    refs.loadMoreButton.classList.remove(\"is-hidden\");\n    refs.loadMoreButton.addEventListener(\"click\", loadMoreSearch);\n    } else {\n     refs.loadMoreButton.classList.add(\"is-hidden\");\n    }\n    \n  } catch (error) {\n    iziToast.show({\n        message: \"Sorry, there are no images matching your search query. Please try again!\"\n    });\n  } finally {\n    hideLoadingIndicator();\n    form.reset();\n  }\n}\n\nasync function searchPictures(requestForSearch) {\n  try {\n    const res = await axios.get(URL, {\n      params: {\n        key: API_KEY,\n        q: requestForSearch,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        per_page: perPage,\n        page: page,\n      },\n    });\n\n    return res.data;\n  } catch (error) {\n    throw new Error(`Error fetching images: ${error.message}`);\n  }\n}\n\nfunction createPicturesMarkup({ likes, views, comments, downloads, tags, webformatURL, largeImageURL }) {\n  return `<li class=\"image-container\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n       <img\n         class=\"gallery-image\"\n         src=\"${webformatURL}\"\n         alt=\"${tags}\"\n       />\n      </a>\n      <div class=\"overlay\">\n      <p>likes<br>${likes}</p>\n      <p>views<br>${views}</p>\n      <p>comments<br>${comments}</p>\n      <p>downloads<br>${downloads}</p></div>\n  </li>`;\n}\n\n\nasync function loadMoreSearch() {\n    page += 1;\n  \n    try {\n      const data = await searchPictures(requestForSearch);\n      const pictures = data.hits;\n  \n      if (pictures.length > 0) {\n        let markup = \" \";\n        for (const pic of pictures) {\n          markup += createPicturesMarkup(pic);\n        }\n        refs.resultContainer.innerHTML += markup;\n  \n        const lightbox = new SimpleLightbox(\".image-container a\", {\n          captionsData: \"alt\",\n          captionDelay: 250,\n        });\n  \n        if (pictures.length >= perPage) {\n          refs.loadMoreButton.classList.remove(\"is-hidden\");\n        } else {\n          refs.loadMoreButton.classList.add(\"is-hidden\");\n        }\n      }\n    } catch (error) {\n      console.error(\"Error loading more pictures:\", error);\n    }\n      const cardHeight = refs.resultContainer.querySelector('.image-container').getBoundingClientRect().height;\n      window.scrollBy({\n      top: cardHeight * perPage,\n      behavior: 'smooth',\n    });\n  }\n  "],"names":["URL","API_KEY","refs","perPage","page","requestForSearch","handleSearch","loadMoreSearch","clearResultContainer","showLoadingIndicator","hideLoadingIndicator","event","form","iziToast","pictures","searchPictures","markup","pic","createPicturesMarkup","lightbox","SimpleLightbox","axios","error","likes","views","comments","downloads","tags","webformatURL","largeImageURL","cardHeight"],"mappings":"owBAMA,MAAMA,EAAK,2BACLC,EAAU,qCAEVC,EAAO,CACT,KAAM,SAAS,eAAe,MAAM,EACpC,gBAAiB,SAAS,eAAe,kBAAkB,EAC3D,iBAAkB,SAAS,cAAc,SAAS,EAClD,eAAgB,SAAS,cAAc,mBAAmB,CAC9D,EAGMC,EAAU,GAChB,IAAIC,EAAO,EACPC,EAAmB,GAEvBH,EAAK,KAAK,iBAAiB,SAAUI,CAAY,EACjDJ,EAAK,eAAe,iBAAiB,QAASK,CAAc,EAE5D,SAASC,GAAuB,CAC9BN,EAAK,gBAAgB,UAAY,EACnC,CAEA,SAASO,GAAuB,CAC9BP,EAAK,iBAAiB,MAAM,QAAU,OACxC,CAEA,SAASQ,GAAuB,CAC9BR,EAAK,iBAAiB,MAAM,QAAU,MACxC,CAEA,eAAeI,EAAaK,EAAO,CACjCA,EAAM,eAAc,EACpB,MAAMC,EAAOD,EAAM,cAMnB,GALAN,EAAmBO,EAAK,SAAS,OAAO,MAAM,KAAI,EAElDJ,IACAC,IAEIJ,EAAiB,SAAW,EAAG,CACjCQ,EAAS,KAAK,CACZ,QAAS,qBACT,MAAO,KACb,CAAK,EACDH,IACAR,EAAK,eAAe,UAAU,IAAI,WAAW,EAC7C,MACD,CAED,GAAI,CAEF,MAAMY,GADO,MAAMC,EAAeV,CAAgB,GAC5B,KACtB,GAAIS,EAAS,SAAW,EAClBD,EAAS,KAAK,CACZ,QAAS,0EACrB,CAAS,MACE,CACH,IAAIG,EAAS,GACb,UAAWC,KAAOH,EACdE,GAASE,EAAqBD,CAAG,EAEzCf,EAAK,gBAAgB,UAAYc,EAG7B,MAAMG,EAAW,IAAIC,EAAe,qBAAsB,CACtD,aAAc,MACd,aAAc,GAC1B,CAAS,CACJ,CACGN,EAAS,OAAS,GACtBZ,EAAK,eAAe,UAAU,OAAO,WAAW,EAChDA,EAAK,eAAe,iBAAiB,QAASK,CAAc,GAE3DL,EAAK,eAAe,UAAU,IAAI,WAAW,CAG/C,MAAC,CACAW,EAAS,KAAK,CACV,QAAS,0EACjB,CAAK,CACL,QAAY,CACRH,IACAE,EAAK,MAAK,CACX,CACH,CAEA,eAAeG,EAAeV,EAAkB,CAC9C,GAAI,CAaF,OAZY,MAAMgB,EAAM,IAAIrB,EAAK,CAC/B,OAAQ,CACN,IAAKC,EACL,EAAGI,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUF,EACV,KAAMC,CACP,CACP,CAAK,GAEU,IACZ,OAAQkB,EAAP,CACA,MAAM,IAAI,MAAM,0BAA0BA,EAAM,SAAS,CAC1D,CACH,CAEA,SAASJ,EAAqB,CAAE,MAAAK,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,EAAW,KAAAC,EAAM,aAAAC,EAAc,cAAAC,GAAiB,CACtG,MAAO;AAAA,sCAC6BA;AAAA;AAAA;AAAA,gBAGtBD;AAAA,gBACAD;AAAA;AAAA;AAAA;AAAA,oBAIIJ;AAAA,oBACAC;AAAA,uBACGC;AAAA,wBACCC;AAAA,QAExB,CAGA,eAAenB,GAAiB,CAC5BH,GAAQ,EAER,GAAI,CAEF,MAAMU,GADO,MAAMC,EAAeV,CAAgB,GAC5B,KAEtB,GAAIS,EAAS,OAAS,EAAG,CACvB,IAAIE,EAAS,IACb,UAAWC,KAAOH,EAChBE,GAAUE,EAAqBD,CAAG,EAEpCf,EAAK,gBAAgB,WAAac,EAElC,MAAMG,EAAW,IAAIC,EAAe,qBAAsB,CACxD,aAAc,MACd,aAAc,GACxB,CAAS,EAEGN,EAAS,QAAUX,EACrBD,EAAK,eAAe,UAAU,OAAO,WAAW,EAEhDA,EAAK,eAAe,UAAU,IAAI,WAAW,CAEhD,CACF,OAAQoB,EAAP,CACA,QAAQ,MAAM,+BAAgCA,CAAK,CACpD,CACC,MAAMQ,EAAa5B,EAAK,gBAAgB,cAAc,kBAAkB,EAAE,sBAAuB,EAAC,OAClG,OAAO,SAAS,CAChB,IAAK4B,EAAa3B,EAClB,SAAU,QAChB,CAAK,CACL"}